<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>spotify</title>
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/style.css">

    <!-- 아이콘 -->
    <script src="https://kit.fontawesome.com/f0e73cfa04.js" crossorigin="anonymous"></script>

</head>
<body>
    <div class="header">
        <div class="logo">
            <a href="#"><img src="img/spotify_logo1.png" alt="spotify_logo"></a>
        </div>
        <div class="top_search">
            <div class="home">
                <a href="#"><i class="fa-solid fa-house"></i></a>
            </div>
            <form id="search_wrapper">
                <!-- <div><i class="fa-solid fa-magnifying-glass"></i></div> -->
                <input type="search" id="search" placeholder="어떤 음악을 듣고 싶으세요?">
                <button type="submit">검색</button>
            </form>
        </div>
        <div class="user_page">
            <a><i class="fa-solid fa-user"></i></a>
            <div>
                <ul class="hidden">
                    <li><a href="#">계정</a></li>
                    <li><a href="#">프로필</a></li>
                    <li><a href="#">설정</a></li>
                    <hr />
                    <li><a href="#">로그아웃</a></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="side_bar block card animate_left" style="display:none" id="mysidebar">
        <ul>
            <li>
                <i class="fa-solid fa-bookmark"></i> 
                <span>내 라이브러리</span>
            </li>
            <li>
                <i class="fa-solid fa-square-plus"></i>
                <span>플레이리스트 만들기</span>
            </li>
            <li>
                <i class="fa-solid fa-heart"></i>
                <span>좋아요 표시한 곡</span>
            </li>
        </ul>

        <p>내플레이리스트 #1</p>
        <p>내플레이리스트 #1</p>
        <p>내플레이리스트 #1</p>
        <p>내플레이리스트 #1</p>
        <p>내플레이리스트 #1</p>
        <p>내플레이리스트 #1</p>
        <p>내플레이리스트 #1</p>
        <p>내플레이리스트 #1</p>
        <p>내플레이리스트 #1</p>
        <p>내플레이리스트 #1</p>
        <p>내플레이리스트 #1</p>
        
    </div>
    <div class="main scroll_bar" >
        <div id="container"> 
            <div class="cont_wrapper">
                <h2><a href="">OO님을 위한 믹스 & 추천</a> </h2>
                <p><a href="">모두보기</a></p>
            </div>
            <div>
                <ul class="list" id="list1">
                    <!-- <li>
                        <img src="" alt="">
                        <h3></h3>
                        <p></p>
                    </li>
                    <li>
                        <img src="" alt="">
                        <h3></h3>
                        <p></p>
                    </li>
                    <li>
                        <img src="" alt="">
                        <h3></h3>
                        <p></p>
                    </li>
                    <li>
                        <img src="" alt="">
                        <h3></h3>
                        <p></p>
                    </li>
                    <li>
                        <img src="" alt="">
                        <h3></h3>
                        <p></p>
                    </li>
                    <li>
                        <img src="" alt="">
                        <h3></h3>
                        <p></p>
                    </li> -->
                </ul>
            </div>
        </div>
        <div > 
            <div class="cont_wrapper">
                <h2><a href=""> 최신 인기 음악</a></h2>
                <p><a href="">모두보기</a></p>
            </div>
            <div>
                <ul class="list">
                    <!-- <li>
                        <img src="" alt="">
                        <h3></h3>
                        <p></p>
                    </li>
                    <li>
                        <img src="" alt="">
                        <h3></h3>
                        <p></p>
                    </li>
                    <li>
                        <img src="" alt="">
                        <h3></h3>
                        <p></p>
                    </li>
                    <li>
                        <img src="" alt="">
                        <h3></h3>
                        <p></p>
                    </li>
                    <li>
                        <img src="" alt="">
                        <h3></h3>
                        <p></p>
                    </li>
                    <li>
                        <img src="" alt="">
                        <h3></h3>
                        <p></p>
                    </li> -->
                </ul>
            </div>
        </div>
        
        <div > 
            <div class="cont_wrapper">
                <h2><a href="">인기아티스트</a></h2>
                <p><a href="">모두보기</a></p>
            </div>
            <div>
                <ul class="list">
                    <!-- <li>
                        <img src="" alt="">
                        <h3></h3>
                        <p></p>
                    </li>
                    <li>
                        <img src="" alt="">
                        <h3></h3>
                        <p></p>
                    </li>
                    <li>
                        <img src="" alt="">
                        <h3></h3>
                        <p></p>
                    </li>
                    <li>
                        <img src="" alt="">
                        <h3></h3>
                        <p></p>
                    </li>
                    <li>
                        <img src="" alt="">
                        <h3></h3>
                        <p></p>
                    </li>
                    <li>
                        <img src="" alt="">
                        <h3></h3>
                        <p></p>
                    </li> -->
                    
                </ul>
                <div id="lastfooter"></div>

            </div>
        </div> -->
    </div> 
    <div class="bottom_bar">
        <div class="now_playing"> <!-- 현재 재생중인 앨범 썸네일 표시-->
            <div>
                <img src="img/noimage.jpg" alt="">
            </div>
            <div>
                <h3>BTS</h3>
                <p>Butter</p>
            </div>
            <div>
                <button><i class="fa-regular fa-heart"></i></button>
            </div>
        </div>
        <div class="controller"><!--플레이컨트롤러-->
            <div><img src="img/controller.png" alt=""></div>
        </div>
        <div class="volume">
            <i class="fa-solid fa-volume-low"></i>
            <input type="range" min="1" max="10"/>
            
        </div> <!--볼륨조절 -->
    </div>

    <script src="../../GSKim/EZen/Javascript/node_modules/axios/dist/axios.min.js"></script>
    <script>

        const list1 = document.querySelector('#list1');
        const clientId = '7dad908171c54d1bbd78abda9ca2471d';
        const clientSecret = 'ada97055bcf849f1b40c0c882c4816a1';
        const token = null;
        document.querySelector('#search_wrapper').addEventListener('submit', (e) => {
            e.preventDefault();

            const queryField = document.querySelector('#search');
            queryKeyword = queryField.value.trim();

            if (!queryKeyword) {  // 검색어를 입력하지 않았을 때
                alert('검색어를 입력하세요');
                queryField.focus();
                return;
            }
            get_music_search();

        });

        async function get_music_search(token) {

            const list = document.querySelector('#list');

            // Array.from(list.getElementsByTagName('li')).map((v, i) => {
            //     list.removeChild(v);
            // });
            
            let json = null;

            try {
                    json = await axios.get('https://api.spotify.com/v1/search?type=album&include_external', {
                        params: {
                            query: queryKeyword,
                        },
                        headers: {
                            'Authorization' : 'Bearer BQD9HJwoWrl0jv61uT6ZsC8KnDKAbya5PY6fKpqSMp8VHdl4IbaIGzb1VYJQniq2g71HfKSfTnusVHKLpd_jUhhHtTyuBb7sulK4hpCpo5weHXmIsj-pSxaLceXSifvXuXo8bb1jZWHwlI46Vkk5UHjlmD2aQMslHvNdGzgKZ5bGBQb7-jRH9yIodM1am601Qchk5JZwjWULB-5_xpgRyyrVVVpghVT4Yrljf_i1mQ5RWF6NVm0pLyWuvw',
                        },
                    });
                    console.log(token);
// BQA_vXdTu-_oBUb8dPX0BUxKT8NxOTapa7JtZTt1pBwcPZt7iKQFvTBzcPoB91pZWGvrOWy6K0Lumjoa7JdiivrtJzNZcySCdxIWU0phg4hYkbnhsmPmpnnTfs7_HxhwACzbmnJIvCWCoMoKgMikRhRdnsEdqCJUrcSPqCofhTEzr-S17Syd6KU670iEmNFU1c2XfgDmniY7duyd8kYKlw
                    // 응답 결과 확인
                    console.log(json);
                }
                catch (error) {
                    console.error(`[Error Code] ${error.code}`);
                    console.error(`[Error Message] ${error.message}`);
                    let alertMsg = error.message;

                    if (error.response !== undefined) {
                        const errorMsg = `${error.response.status} error - ${error.response.statusText}`;
                        console.error(`[HTTP Status] ${errorMsg}`);

                        alertMsg += `\n${errorMsg}`;
                    }
                    alert(alertMsg);
                    return;
                }

                const { data } = json;

                data.albums['items'].map((v, i) => {
                    console.log(v);
                    console.log(v.name);

                    const li = document.createElement('li');
                    list1.appendChild(li);

                    const a = document.createElement('a');
                    a.setAttribute('href', v.external_urls);
                    a.setAttribute('target', '_blank');
                    li.appendChild(a);
                    
                    const img = document.createElement('img');
                    img.setAttribute('src', v.images[0].url);
                    a.appendChild(img);

                    const title = document.createElement('span');
                    title.innerHTML = v.name;
                    li.appendChild(title);
                }); 

            const APIController = (function() {

            // private methods
            const _getToken = async () => {

                const result = await fetch('https://accounts.spotify.com/api/token', {
                    method: 'POST',
                    headers: {
                        'Content-Type' : 'application/x-www-form-urlencoded', 
                        'Authorization' : 'Basic ' + btoa(clientId + ':' + clientSecret)
                    },
                    body: 'grant_type=client_credentials'
                });
                console.log(clientId);
                console.log(clientSecret);

                tokenData = await result.json();
                console.log(tokenData);
                return tokenData.access_token;
            }

            return {
                getToken() {
                    return _getToken();
                },
            }
        })();


        // UI Module
        const UIController = (function() {
            //public methods
            return {

                //method to get input fields
                inputField() {
                    return {

                    }
                },
            }

        })();
    }
    </script>

</body>
</html>